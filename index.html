<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Raspberry Pi Web Server by sean-hill</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Raspberry Pi Web Server</h1>
      <h2 class="project-tagline">How I built a home web server with a Raspberry Pi</h2>
      <a href="https://github.com/sean-hill/raspberry-pi-web-server" class="btn">View on GitHub</a>
      <a href="https://github.com/sean-hill/raspberry-pi-web-server/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/sean-hill/raspberry-pi-web-server/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="raspberry-pi-express-web-server" class="anchor" href="#raspberry-pi-express-web-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>Raspberry Pi Express Web Server</h1>

<p>This is how I built a home web server with a Raspberry Pi, Node JS, and an Express Server.</p>

<h2>
<a id="purchases" class="anchor" href="#purchases" aria-hidden="true"><span class="octicon octicon-link"></span></a>Purchases</h2>

<ol>
<li><a href="http://amzn.com/B00LPESRUK">Raspberry Pi B+</a></li>
<li><a href="http://amzn.com/B00GWDLJGS">Power Supply</a></li>
<li>
<a href="http://amzn.com/B00DYQYLQQ">Micro SD Card</a> (At least 8 GB)</li>
<li>
<a href="http://amzn.com/B00MQLB1N6">Case</a> (Optional)</li>
</ol>

<p><img src="https://www.dropbox.com/s/euujwu3nowunjtk/raspberry-pi.jpg?dl=1" alt="Rasberry Pi"></p>

<h2>
<a id="hardware" class="anchor" href="#hardware" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hardware</h2>

<ol>
<li>Raspberry Pi B+</li>
<li>Power Supply for Raspberry Pi</li>
<li>Modem and Router</li>
<li>Ethernet Cord</li>
</ol>

<h2>
<a id="setup" class="anchor" href="#setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup</h2>

<ol>
<li>Install the operating system by following <a href="https://www.raspberrypi.org/help/noobs-setup/">these steps</a>
</li>
<li>
<p>Once the operating system is installed, from the command line update the software to the latest.</p>

<pre><code>$ sudo apt-get update; sudo apt-get upgrade
</code></pre>
</li>
<li>
<p>If wanted, change the default <code>pi</code> user password to something more secure.</p>

<pre><code>$ sudo raspi-config
</code></pre>
</li>
<li>Navigate to <code>2 Change User Password</code> and follow the steps.</li>
</ol>

<h2>
<a id="install-latest-nodejs" class="anchor" href="#install-latest-nodejs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install latest NodeJS</h2>

<pre><code>$ wget http://node-arm.herokuapp.com/node_latest_armhf.deb
$ sudo dpkg -i node_latest_armhf.deb
$ node -v
</code></pre>

<h2>
<a id="install-git-and-fork-this-repo" class="anchor" href="#install-git-and-fork-this-repo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install Git and fork this repo</h2>

<pre><code>$ sudo apt-get install git
</code></pre>

<p>Fork <a href="https://github.com/sean-hill/raspberry-pi-web-server.git">this</a> repo so that you can commit your own updates later on, then clone your repo to your Pi.</p>

<pre><code>$ cd ~/
$ git clone &lt;your-forked-url&gt;
</code></pre>

<h2>
<a id="run-the-webserver" class="anchor" href="#run-the-webserver" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run the Webserver</h2>

<pre><code>$ cd ~/raspberry-pi-web-server
$ npm install
$ node server.js
</code></pre>

<p>Open a browser and go to <code>&lt;your-pi's-IP&gt;:5000</code></p>

<p>You did it! You successfully ran a webserver on your Raspberry Pi. Now what? How about we open up your router to the outside world and setup a deployment method.</p>

<h2>
<a id="dynamic-dns" class="anchor" href="#dynamic-dns" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dynamic DNS</h2>

<p>In order for your buddies to access your home web server, you'll need your own domain name that points to your router's dynamic IP provided by your local ISP. I went with the free version of <a href="http://www.noip.com/">noip.com</a>. After creating an account with noip, follow these steps.</p>

<pre><code>$ cd ~/
$ wget http://www.no-ip.com/client/linux/noip-duc-linux.tar.gz
$ tar vzxf noip-duc-linux.tar.gz
$ cd noip-2.1.9-1
$ sudo make
$ sudo make install
</code></pre>

<p>Follow the commands (entering in your username and password from noip) and then start the process.</p>

<pre><code>$ sudo /usr/local/bin/noip2
</code></pre>

<p>Now we want this to start whenever your raspberry pi boots, so follow <a href="http://www.stuffaboutcode.com/2012/06/raspberry-pi-run-program-at-start-up.html">this</a> tutorial to create a startup script if you want it.</p>

<h2>
<a id="static-raspberry-pi-ip-address" class="anchor" href="#static-raspberry-pi-ip-address" aria-hidden="true"><span class="octicon octicon-link"></span></a>Static Raspberry Pi IP Address</h2>

<p>Whenever your Raspberry Pi reboots, it'll get a new dynamic IP from your router. We'd rather not have this happen, so let's make it a static IP instead. I followed <a href="http://www.modmypi.com/blog/tutorial-how-to-give-your-raspberry-pi-a-static-ip-address">this</a> tutorial to accomplish this.</p>

<h2>
<a id="open-your-router-to-the-world" class="anchor" href="#open-your-router-to-the-world" aria-hidden="true"><span class="octicon octicon-link"></span></a>Open your router to the world</h2>

<p>You need to enable single port forwarding on your local router. Our webserver is running on port 5000, so I followed <a href="http://www.noip.com/support/knowledgebase/port-forwarding-on-a-linksys-wrt610n-router/">this</a> tutorial to open up that port on my router. It may be different for each router.</p>

<p><img src="https://www.dropbox.com/s/w98zjpjvm5atnu7/single-port-forwarding.png?dl=1" alt="Single Port Forwarding"></p>

<p>After saving these port forwarding settings, start up your server with <code>node server.js</code>, and you should be able to navigate to <code>http://&lt;your-domain&gt;.ddns.net:5000</code> and see our Raspian homepage!</p>

<p>I'd love to get rid of the <code>:5000</code> at the end of our url, but unfortunately my ISP restricts access to port <code>80</code>, so I can't use a proxy service such as <code>nginx</code> at this time to proxy pass through all the requests at port <code>80</code> to port <code>5000</code>.</p>

<h2>
<a id="automated-deployment" class="anchor" href="#automated-deployment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Automated Deployment</h2>

<p>Well, you've done it, you can successfully view a webpage hosted on your raspberry pi from the outside world. For me, that's just the first step. I want to be able to development on my local computer, and push them changes to my pi simply!</p>

<h3>
<a id="pm2" class="anchor" href="#pm2" aria-hidden="true"><span class="octicon octicon-link"></span></a>PM2</h3>

<p>I <g-emoji alias="heart" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/2764.png">❤️</g-emoji> <a href="https://github.com/Unitech/pm2">pm2</a>. It's a great module to deploy your nodejs applications. First let's install it on both your computer and your raspberry pi.</p>

<pre><code>$ sudo npm install -g pm2
</code></pre>

<p>I like to store my web server in the <code>/var/www</code>. So let's first create that directory and then make the <code>pi</code> user the owner.</p>

<pre><code>$ sudo mkdir /var/www
$ sudo chown pi /var/www
$ sudo chgrp pi /var/www
</code></pre>

<p>Now we'll use pm2 to deploy straight from our local machine to our raspberry pi, but first we need to be able to ssh into our raspberry pi. </p>

<pre><code>$ sudo raspi-config
$ 8 Advanced Options
$ A4 SSH
$ Enable
</code></pre>

<p>Then you'll need to setup another single port forwarding on your router to allow SSH into your home. For my linksys router I had to find out what port allowed remote access on my router by going to <code>Administration</code> and seeing the port under <code>Remote Management Port</code>. It was <code>8080</code> for me. Then I setup the following single port forwarding.</p>

<p><img src="https://www.dropbox.com/s/5yjmevrbm8glzq8/ssh-port-forwarding.png?dl=1" alt="SSH port forwarding"></p>

<pre><code>External Port: 8080
Internal Port: 22
Protocol: Both
To IP Address: &lt;your pi IP&gt;
Enabled: Checked
</code></pre>

<p>Test that your SSH works by executing this command.</p>

<pre><code>$ ssh -p 8080 pi@&lt;your domain&gt;.ddns.net
</code></pre>

<p>Now on your local computer clone this repo.</p>

<pre><code>$ git clone https://github.com/sean-hill/raspberry-pi-web-server.git
</code></pre>

<p>Then edit the <code>ecosystem.json</code> file and replace the variables between <code>&lt; &gt;</code> with your appropriate fields. Once you've done that, execute the following commands on your computer to setup your project on your raspberry pi.</p>

<pre><code>$ pm2 deploy ecosystem.json production setup
$ pm2 deploy ecosystem.json production
</code></pre>

<p>You'll be prompted to enter your <code>pi</code> password multiple times. If this bothers you, I recommend creating public/private ssh keys on your computer and to copy your public key to your raspberry pi as described <a href="https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md">here</a>.</p>

<p>Now head back over to your raspberry pi, and exectute these commands.</p>

<pre><code>$ cd /var/www
$ pm2 list
</code></pre>

<p>You should see your app running and be able to access your server from your browser at <code>&lt;your-domain&gt;.ddns.net:5000</code>!</p>

<pre><code>│ Web Server │ 0 │ fork │ 10488 │ online │ 7 │ 6m │ 22.156 MB │ disabled │
</code></pre>

<p>Now every time you make changes to your server, commit the changes, push them up, and then deploy your app using pm2. You never have to SSH into your Raspberry Pi.</p>

<h2>
<a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion</h2>

<p>This is a bit of tedious process, but you just set up your own personal web server for less then 50 bucks. Pretty sweet! Good luck and let me know if this process could be improved!</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/sean-hill/raspberry-pi-web-server">Raspberry Pi Web Server</a> is maintained by <a href="https://github.com/sean-hill">sean-hill</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
